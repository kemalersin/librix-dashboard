!function(e){"use strict";var t,a={},l={},i=function(t,a){a&&(r.unslider("animate:first"),c.rows().deselect()),e("html, body").stop().animate({scrollTop:e(t).offset().top-e(".navbar-fixed-top").height()},1250,"easeInOutExpo")},o=function(t){e(".amcharts-chart-div a").remove()},s=function(e){i("#institutions",!0),c.columns(1).search(e.mapObject.title).draw()},n=function(e){i("#institutions",!0),c.columns(1).search("").draw()},r=e("#institutions").unslider({arrows:!1,autoplay:!1,keys:!1,nav:!1});r.on("unslider.change",function(t,a,l){2===a&&setTimeout(function(){e("img.lazy.collapse").fadeIn("slow")},500)}),e("body").scrollspy({target:".navbar-fixed-top",offset:51}),window.sr=ScrollReveal(),sr.reveal(".sr-contact",{duration:600,scale:.3,distance:"0px"},300),e("a.page-scroll").click(function(t){t.preventDefault(),i(e(this).attr("href"))}),e(".navbar-collapse ul li a:not(.dropdown-toggle)").click(function(){e(".navbar-collapse > ul > li.active").removeClass("active"),e(this).parent("li").addClass("active"),e(".navbar-toggle:visible").click()}),e(document).on("click","a.slide-back",function(t){var a=e(this);t.preventDefault(),r.unslider("prev"),a.hasClass("to-institutions")?c.rows().deselect():a.hasClass("to-activities")&&d.rows().deselect()}).on("click",".thumb",function(){e(".thumb.selected").removeClass("selected"),e(this).addClass("selected"),e(".main-img").find("img").hide().attr("src",this.src).fadeIn(1e3)});var d,c=e("#institutions-table").DataTable({ajax:"/institutions",pageLength:25,processing:!0,scrollX:!0,scrollY:396,select:{style:"single",blurable:!0,info:!1,className:"row-selected"},columns:[{data:"Kod",width:"10%"},{data:"Il",width:"10%"},{data:"Ilce",width:"10%"},{data:"Tanim",width:"30%"},{data:"ToplamEtkinlik",width:"13%",type:"html-num",className:"text-center"},{data:"GerceklesenEtkinlik",width:"14%",type:"html-num",className:"text-center"},{data:"KalanEtkinlik",width:"13%",type:"html-num",className:"text-center"}],order:[[1,"asc"],[2,"asc"]],columnDefs:[{targets:[1],orderData:[1,2]}],language:{url:"/js/datatables/Turkish.json"}});c.on("select",function(a,l,i,o){e.map(l.rows({selected:!0}).data(),function(a){var i="undefined"==typeof d;t=a.Kod,i||d.destroy(),d=e("#activities-table").DataTable({ajax:"/activities/"+a.Kod,pageLength:l.page.len(),destroy:!0,processing:!0,scrollX:!0,select:{style:"single",blurable:!0,info:!1,className:"row-selected"},dom:'<"row"<"dt-info col-sm-6"><"col-sm-6 hidden-xs"f>>rt<"row"<"col-sm-6"i><"col-sm-6"p>>',columns:[{data:"BaslangicTarihi",width:"15%",type:"date"},{data:"BitisTarihi",width:"15%",type:"date"},{data:"Konu",width:"45%"},{data:"IlgiliKisi",width:"20%"},{data:"Tamamlandi",width:"15%"}],columnDefs:[{targets:[0,1],render:function(e,t,a,l){return moment(e).format("DD.MM.Y")}},{targets:4,render:function(e,t,a,l){return e===!0?'<i class="fa fa-check-square-o text-success"></i> Tamamlandı':'<i class="fa fa-square-o text-danger"></i> Tamamlanmadı'}}],order:[[0,"asc"]],language:{url:"/js/datatables/Turkish.json"}}),d.one("draw",function(){e(".container.activities").find(".dt-info").html('<a href class="slide-back to-institutions"><i class="fa fa-chevron-left" aria-hidden="true"></i></a> <span class="text-primary"><strong>'+a.Tanim+" Etkinlikleri</strong></span>"),r.unslider("next")}),i&&d.on("select",function(a,l,i,o){e.map(l.rows({selected:!0}).data(),function(a){e.get("/activity/"+t+"/"+a.Id,function(t){var a=e(".container.activity"),l=a.find(".images"),i=a.find(".info"),o=t.BaslangicTarihi,s=t.BitisTarihi,n=moment(s).diff(o,"d");0===n&&n++,a.find(".subject").text(t.Konu),a.find(".date span").text(moment(o).format("DD.MM.Y")+" ("+n+" gün)"),a.find(".summary").html("<strong>"+t.Ozet+"</strong>"),a.find(".description").html('<div class="text">'+t.Aciklama+"</div>"),a.find(".text").mCustomScrollbar({theme:"inset-dark",scrollButtons:{enable:!0},advanced:{updateOnContentResize:!0}}),l.find(".thumbnails").html(""),"undefined"==typeof t.Gorseller||0===t.Gorseller.length?(l.hide(),i.removeClass("col-sm-6").addClass("col-sm-12")):(l.show(),i.removeClass("col-sm-12").addClass("col-sm-6"),l.find(".main-img").html('<img class="lazy collapse" src="'+t.Gorseller[0]+'" />'),t.Gorseller.length>1?(l.find(".row:first-child").height(365),l.find(".row:last-child").show(),t.Gorseller.forEach(function(e){l.find(".thumbnails").append('<img class="lazy thumb collapse" src="'+e+'" />')}),l.find(".thumb:first-child").addClass("selected")):(l.find(".row:first-child").height(436),l.find(".row:last-child").hide())),r.unslider("next")})})})})}),AmCharts.makeChart("map",{type:"map",autoDisplay:!0,theme:"light",colorSteps:10,dataProvider:{map:"turkeyHigh",getAreasFromMap:!0},valueLegend:{right:10,minValue:"Hiç Yok",maxValue:"Çok Fazla",color:"#fff"},areasSettings:{autoZoom:!1,selectable:!0,balloonText:"[[title]]:<strong>[[value]]</strong> ([[percent]]%)"},dataLoader:{url:"/mapdata",format:"json"},listeners:[{event:"rendered",method:o},{event:"clickMapObject",method:s},{event:"homeButtonClicked",method:n}]}),l.chart1={theme:"light",type:"serial",startDuration:2,dataLoader:{url:"/charts/top-10-counties",format:"json"},valueAxes:[{position:"left",title:"Etkinlikler",titleColor:"#193b2b",titleFontSize:14}],graphs:[{balloonText:"[[category]]: <b>[[value]]</b>",fillColorsField:"color",fillAlphas:1,lineAlpha:.1,type:"column",valueField:"activities"}],depth3D:20,angle:30,chartCursor:{categoryBalloonEnabled:!1,cursorAlpha:0,zoomable:!1},categoryField:"county",categoryAxis:{gridPosition:"start",labelRotation:45},listeners:[{event:"rendered",method:o}]},l.chart2={theme:"light",type:"serial",startDuration:2,dataLoader:{url:"/charts/top-10-institutions",format:"json"},valueAxes:[{position:"left",title:"Etkinlikler",titleColor:"#451c32",titleFontSize:14}],graphs:[{balloonText:"[[category]]: <b>[[value]]</b>",fillColors:"#e4c2d2",fillAlphas:1,lineAlpha:.1,type:"column",valueField:"activities"}],depth3D:20,angle:30,rotate:!0,categoryField:"institute",categoryAxis:{color:"#e4c2d2",gridPosition:"start",fillAlpha:.05,position:"right"},listeners:[{event:"rendered",method:o}]},l.chart3={type:"serial",theme:"light",marginRight:40,marginLeft:40,autoMarginOffset:20,dataLoader:{url:"/charts/activities-by-month",format:"json"},synchronizeGrid:!0,valueAxes:[{id:"v1",axisAlpha:0,position:"left",ignoreAxisWidth:!0},{id:"v2",axisAlpha:1,position:"right",title:"Tamamlananlar",titleColor:"#3d4715",titleFontSize:14}],balloon:{borderThickness:1,shadowAlpha:0},graphs:[{id:"g1",valueAxis:"v1",balloon:{drop:!0,adjustBorderColor:!1,color:"#ffffff"},bullet:"round",bulletBorderAlpha:1,bulletColor:"#2bc792",bulletSize:5,hideBulletsCount:50,lineThickness:2,lineColor:"#c9ed4c",title:"red line",useLineColorForBulletBorder:!0,valueField:"activities",balloonText:'<span style="font-size:18px;">[[value]]</span>'},{id:"g2",valueAxis:"v2",balloon:{drop:!0,adjustBorderColor:!1,color:"#ffffff"},bullet:"square",bulletBorderAlpha:1,bulletColor:"#2bc792",bulletSize:5,hideBulletsCount:50,lineThickness:2,lineColor:"#FCD202",title:"red line",useLineColorForBulletBorder:!0,valueField:"completed",balloonText:'<span style="font-size:18px;">[[value]]</span>'}],chartCursor:{valueLineEnabled:!0,valueLineBalloonEnabled:!0,cursorAlpha:1,cursorColor:"#258cbb",limitToGraph:"g1",valueLineAlpha:.2},categoryField:"month",categoryAxis:{dashLength:1,minorGridEnabled:!0},listeners:[{event:"rendered",method:o}]},e("#charts").unslider().on("unslider.change",function(e,t,i){setTimeout(function(){var e="chart"+(parseInt(t)+1);"undefined"==typeof a[e]&&(a[e]=AmCharts.makeChart(e,l[e]))},750)}),e(window).scroll(function(){if("undefined"==typeof a.chart1){var t=e("#chart1").offset().top,i=e("#chart1").outerHeight(),o=e(window).height(),s=e(this).scrollTop();s>t+i-o&&(a.chart1=AmCharts.makeChart("chart1",l.chart1))}})}(jQuery);